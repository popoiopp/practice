#include<iostream>
#include<vector>
#include"ListNode.h"
using namespace std;
ListNode<int>* make(void)
{
   ListNode<int>*dummyhead=new ListNode<int>(-1);
   ListNode<int>*cur=dummyhead;
   int num;
   cout<<"请输入链表结点个数";
   cin>>num;
   for(int i=0;i<num;i++)
   {
      int val;
      cin>>val;
      cur->next=new ListNode<int>(val);
      cur=cur->next;
   }
  ListNode<int>*head=dummyhead->next;
  delete dummyhead;
  return head;
}
void outpute(ListNode<int>*head)
{
    while(head!=nullptr)
    {
        cout<<head->val<<' ';
        head=head->next;
    }
}
int NumsofList(ListNode<int>*head)//获取链表结点个数
{
    
    int res=1;
    while(head!=nullptr){
        head=head->next;
        res++;
    }
    return res;
}
ListNode<int>*cut(ListNode<int>*head,int n)//将链表在指定位置切成两段，并返回后面一段
{
    ListNode<int>*cur;
    
    for(int i=1;i<n&&head;i++)
    {
         head=head->next;
    }
    if(!head){
        return nullptr;
    }
    cur=head->next;
    head->next=nullptr;
    return cur;
}
ListNode<int>*merge(ListNode<int>*l1,ListNode<int>*l2,ListNode<int>*head)//将两条有序链表合并为一条
{
    ListNode<int>*cur=head;
    while(l1!=nullptr&&l2!=nullptr)
    {
        if(l1->val<l2->val){
            cur->next=l1;
            l1=l1->next;
        }else{
            cur->next=l2;
            l2=l2->next;
        }
        cur=cur->next;
    }
    cur->next=l1==nullptr?l2:l1;
  
    while(cur->next!=nullptr){
        cur=cur->next;
    }
    return cur;
}
int main(void)
{
   ListNode<int>*head=make();
   int len=NumsofList(head);
   ListNode<int>*dummyhead=new ListNode<int>(-1);
   dummyhead->next=head;
   for(int i=1;i<len;i*=2)
   {
    ListNode<int>*cur=dummyhead->next;
    ListNode<int>*prve=dummyhead;
    while(cur!=nullptr)
    {
        ListNode<int>*left=cur;
        ListNode<int>*right=cut(left,i);
        cur=cut(right,i);
        prve=merge(left,right,prve);
    }
        

   }
   outpute(dummyhead->next);          

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       




